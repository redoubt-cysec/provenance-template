# Setting Up Private Vulnerability Reporting

This guide explains how to enable GitHub's Private Vulnerability Reporting feature for your repository.

## What is Private Vulnerability Reporting?

Private vulnerability reporting allows security researchers and users to privately report potential security vulnerabilities directly to repository maintainers through GitHub's Security Advisories feature, without exposing the vulnerability publicly.

## Benefits

- Secure, private channel for reporting vulnerabilities
- Built-in workflow for coordinated disclosure
- CVE assignment capability
- Integration with GitHub's security advisory database
- Standardized reporting form for researchers

## Prerequisites

- Repository must be public
- You must have admin access to the repository
- Repository must not be a fork (or fork must have Security tab enabled)

## Step-by-Step Setup

### 1. Enable Security Features

1. Go to your repository on GitHub
2. Click on **Settings** (gear icon in the top menu)
3. In the left sidebar, click on **Code security and analysis**

### 2. Enable Private Vulnerability Reporting

1. Scroll down to the **Private vulnerability reporting** section
2. Click **Enable** button
3. Confirm the action if prompted

### 3. Verify Setup

1. Go to your repository's **Security** tab
2. You should see a button labeled **"Report a vulnerability"**
3. Click it to verify the advisory form loads correctly

### 4. Configure Security Policy

Ensure your [SECURITY.md](../../SECURITY.md) file mentions this feature:

```markdown
## Reporting a Vulnerability

We use GitHub's private vulnerability reporting feature:

1. Go to the [Security tab](../../security)
2. Click "Report a vulnerability"
3. Fill out the advisory form
```

### 5. Set Up Notifications (Optional)

Configure who receives vulnerability reports:

1. Go to **Settings** > **Code security and analysis**
2. Under **Private vulnerability reporting**, click **Configure security advisories**
3. Add team members or collaborators who should receive notifications
4. Set up email notifications for security advisories

## What Happens When Someone Reports a Vulnerability?

1. **Reporter submits:** User clicks "Report a vulnerability" and fills out the form
2. **Private advisory created:** GitHub creates a private security advisory
3. **Maintainers notified:** Repository admins receive an email and GitHub notification
4. **Collaborate privately:** You can discuss the issue with the reporter in the advisory
5. **Develop a fix:** Work on a patch in a private temporary fork if needed
6. **Request CVE:** Optionally request a CVE ID from GitHub
7. **Publish advisory:** After deploying the fix, publish the advisory to inform users
8. **Credit reporter:** Reporter gets credit in the published advisory (if they want)

## Managing Reported Vulnerabilities

### Access Security Advisories

1. Go to **Security** tab
2. Click **Advisories**
3. View **Reported** and **Published** advisories

### Response Workflow

When a vulnerability is reported:

1. **Acknowledge receipt** (within 48 hours recommended)
2. **Assess severity** using CVSS scoring
3. **Verify the issue** - reproduce if possible
4. **Develop a fix** - use temporary private fork if needed
5. **Test thoroughly**
6. **Coordinate disclosure** with reporter
7. **Release patch** and publish advisory
8. **Notify users** via release notes and advisory

### Advisory States

- **Draft:** Working on fix, not published
- **Published:** Advisory is public, fix is available
- **Closed:** Issue resolved or determined not a vulnerability

## Best Practices

### Response Time Commitments

Set clear expectations in your SECURITY.md:

```markdown
- Initial Response: Within 48 hours
- Status Updates: Every 72 hours until resolved
- Fix Timeline:
  - Critical: Within 7 days
  - High: Within 14 days
  - Other: Within 30 days
```

### Communication

- Keep the reporter updated regularly
- Be respectful and professional
- Credit reporters appropriately
- Use draft advisories for collaboration

### Security

- Don't discuss vulnerabilities in public issues or PRs
- Use private forks for developing fixes
- Coordinate disclosure timing with reporter
- Give users time to update before publishing advisory

## Disabling the Feature

If you need to disable private vulnerability reporting:

1. Go to **Settings** > **Code security and analysis**
2. Under **Private vulnerability reporting**, click **Disable**
3. Update your SECURITY.md to remove references to this feature

## Alternative Reporting Methods

Always provide alternative contact methods in case GitHub is unavailable:

```markdown
### Alternative: Email

If you cannot use GitHub's private reporting:

- Email: security@[YOUR-DOMAIN].com
- Subject: SECURITY: [brief description]
```

## Troubleshooting

### "Report a vulnerability" button not visible

- Ensure the feature is enabled in Settings
- Check that the repository is public
- Verify you're viewing the correct repository

### Can't enable the feature

- Repository must be public (not private)
- Repository must not be a fork, or fork must have security enabled
- You need admin access

### Not receiving notifications

- Check your GitHub notification settings
- Verify email address is confirmed
- Check your email filters/spam folder
- Add security@github.com to your contacts

## Additional Resources

- [GitHub Docs: Private Vulnerability Reporting](https://docs.github.com/en/code-security/security-advisories/guidance-on-reporting-and-writing/privately-reporting-a-security-vulnerability)
- [GitHub Docs: Managing Security Advisories](https://docs.github.com/en/code-security/security-advisories/repository-security-advisories)
- [Coordinated Disclosure Best Practices](https://vuls.cert.org/confluence/display/CVD/Executive+Summary)
- [CVSS Calculator](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator)

## Integration with This Template

This template is designed with security in mind:

- SECURITY.md files already reference private reporting
- Automated security testing catches many issues
- SLSA provenance helps verify authentic releases
- SBOM and vulnerability scanning for dependencies

Enabling private vulnerability reporting completes your security posture by providing a secure channel for external researchers to help identify issues.

---

**Next Steps:**

1. Enable private vulnerability reporting (follow steps above)
2. Customize SECURITY.md with your email address
3. Add security team members to receive notifications
4. Test the reporting flow with a team member
5. Announce the security policy to your users
